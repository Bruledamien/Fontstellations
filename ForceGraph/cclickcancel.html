<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>
<script>
        function clickcancel() {
            // we want to a distinguish single/double click
            // details http://bl.ocks.org/couchand/6394506
            var event = d3.dispatch('click', 'dblclick');

            function cc(selection) {
                var down, tolerance = 5, last, wait = null, args;
                // euclidean distance
                function dist(a, b) {
                    return Math.sqrt(Math.pow(a[0] - b[0], 2), Math.pow(a[1] - b[1], 2));
                }
                selection.on('mousedown', function() {
                    down = d3.mouse(document.body);
                    last = +new Date();
                    args = arguments;
                });
                selection.on('mouseup', function() {
                    if (dist(down, d3.mouse(document.body)) > tolerance) {
                        return;
                    } else {
                        if (wait) {
                            window.clearTimeout(wait);
                            wait = null;
                            event.apply('dblclick', this, args); //changed from original (d3 v3)
                        } else {
                            wait = window.setTimeout((function() { //changed
                                return function() {
                                    event.apply('click', this, args);
                                    wait = null;
                                };
                            })(), 300);
                        }
                    }
                });
            };
            return d3.rebind(cc, event, 'on');
        }
</script>
</body>
</html>